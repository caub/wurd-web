!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("wurd",[],e):"object"==typeof exports?exports.wurd=e():t.wurd=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.encodeQueryString=function(t){return Object.keys(t).map(function(e){var n=t[e];return encodeURIComponent(e)+"="+encodeURIComponent(n)}).join("&")}},function(t,e,n){"use strict";function r(t,e){function n(t){if(!(r=r[t]))return!0}if(!o(t)||"string"!=typeof e)return t;var r=t;return i(e.split("."),n),r}var o=n(4),i=n(2);t.exports=r},function(t,e,n){"use strict";function r(t,e){for(var n=t.length,r=-1;++r<n;)if(e(t[r],r,t))return!0;return!1}t.exports=r},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(1),c=function(t){return t&&t.__esModule?t:{default:t}}(a),s=n(0),f=function(){function t(){o(this,t),this.appName=null,this.options={},this.content={}}return u(t,[{key:"connect",value:function(t,e){switch(this.appName=t,this.options=i({},e),this.options.editMode){case!0:this.startEditor();break;case"querystring":/[?&]edit(&|$)/.test(location.search)&&this.startEditor()}}},{key:"load",value:function(t){var e=this,n=this.appName,r=this.options;return new Promise(function(o,u){var a=e.content[t];if(a)return console.info("from cache: ",t),o(a);console.info("from server: ",t);var c=(0,s.encodeQueryString)(r),f="https://api-v3.wurd.io/apps/"+n+"/content/"+t+"?"+c;return fetch(f).then(function(n){if(!n.ok)throw new Error("Error loading "+t+": "+n.statusText);return n.json().then(function(t){i(e.content,t),o(t)})})})}},{key:"get",value:function(t,e){var n=this.options,r=this.content;return n.draft&&(e=void 0!==e?e:"["+t+"]"),(0,c.default)(r,t)||e}},{key:"map",value:function(t,e){var n=this.content,o=(0,c.default)(n,t)||r({},Date.now(),{}),i=0;return Object.keys(o).map(function(n){var r=o[n],u=i;return i++,e(r,[t,n].join("."),u)})}},{key:"startEditor",value:function(){var t=this.appName,e=this.options;this.options.draft=!0;var n=document.createElement("script");n.src="https://edit-v3.wurd.io/widget.js",n.async=!0,n.setAttribute("data-app",t),e.lang&&n.setAttribute("data-lang",e.lang),document.getElementsByTagName("body")[0].appendChild(n)}}]),t}();e.default=new f,t.exports=e.default},function(t,e,n){"use strict";function r(t){return!(null==t||"object"!==(void 0===t?"undefined":o(t))||Array.isArray(t))}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=r}])});